(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1094554a"],{"08ce":function(t,e,n){"use strict";var i=n("49d8"),s=n.n(i);s.a},"0b86":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comitem icon"},[n("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",placeholder:"请输入内容",minlength:"2",maxlength:"150","show-word-limit":"",resize:"none",rows:"3",id:"text"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),n("div",{staticClass:"combottom"},[n("img",{staticClass:"emoji-panel-btn",attrs:{src:"/images/face.png"},on:{click:function(e){t.showEmoji=!t.showEmoji}}}),n("div",{staticClass:"two"},[t.disabled?t._e():n("el-input",{staticClass:"post",attrs:{type:"text",placeholder:"用户名",minlength:"2",maxlength:"8"},model:{value:t.fromUser,callback:function(e){t.fromUser=e},expression:"fromUser"}}),n("el-button",{staticStyle:{width:"70px"},attrs:{type:"primary"},on:{click:t.postComment}},[t._v("评论")])],1),t.showEmoji?n("emoji-panel",{attrs:{top:t.top,left:t.left,width:t.width,datawidth:"400px"},on:{emojiClick:t.appendEmoji}}):t._e()],1)],1)},s=[],a=(n("ac1f"),n("5319"),n("6180")),o={data:function(){return{showEmoji:!1,content:"",fromUser:"",disabled:!1}},created:function(){},props:["top","left","width"],mounted:function(){this.disabled=this.$store.state.isLogin},components:{EmojiPanel:a["a"]},methods:{postComment:function(){this.content=this.content.replace(/:.*?:/g,this.emoji);var t={};if(this.$store.state.isLogin)t={name:"博主",isAuthor:!0};else{if(""==this.fromUser||""==this.content)return void this.$notify.error({title:"错误",message:"用户名或者评论不能为空"});t={name:this.fromUser,isAuthor:!1}}this.$emit("handleCom",{fromUser:t,c_content:this.content,c_date:new Date}),this.content="",this.fromUser="",this.showEmoji=!1},emoji:function(t){var e=t.substring(1,t.length-1);return'<span class="emoji-item-common emoji-'.concat(e,' emoji-size-small" ></span>')},appendEmoji:function(t){var e=document.getElementById("text");this.content=e.value+":"+t+":",this.showEmoji=!1}}},r=o,c=(n("bb13"),n("2877")),l=Object(c["a"])(r,i,s,!1,null,"adebeb84",null);e["a"]=l.exports},"2e78":function(t,e,n){},3082:function(t,e,n){"use strict";var i=n("d547"),s=n.n(i);s.a},"49d8":function(t,e,n){},6180:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"emoji-panel-wrap",style:{width:t.width,top:t.top,left:t.left}},[n("vue-scroll",{attrs:{ops:t.ops}},t._l(t.emojis,(function(e,i){return n("emoji",{key:i,attrs:{text:e},on:{onClick:t.handleEmojiClick}})})),1)],1)},s=[],a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"emoji-item-common",class:["emoji-"+t.text,t.isInput?"emoji-size-small":"emoji-size-large"],on:{click:t.emojiClick}})},o=[],r={data:function(){return{}},components:{},props:["text","isInput"],methods:{emojiClick:function(){this.$emit("onClick",this.text)}}},c=r,l=n("2877"),m=Object(l["a"])(c,a,o,!1,null,null,null),d=m.exports,u={data:function(){return{emojis:["angry","anguished","astonished","blush","cold_sweat","confounded","confused","cry","disappointed","disappointed_relieved","dizzy_face","expressionless","fearful","flushed","frowning","grimacing","grin","grinning","heart_eyes","hushed","innocent","joy","kissing_closed_eyes","kissing_heart","laughing","neutral_face","no_mouth","open_mouth","pensive","persevere","relaxed","relieved","sleepy","smile","smiley","smirk","sob","stuck_out_tongue","sunglasses","sweat","sweat_smile","scream","wink","unamused","satisfied","worried","stuck_out_tongue_closed_eyes","weary","yum","tired_face","triumph","stuck_out_tongue_winking_eye"],ops:{vuescroll:{sizeStrategy:"percent",detectResize:!0},scrollPanel:{},rail:{},bar:{showDelay:500,onlyShowBarOnScroll:!1,keepShow:!0,background:"#b3c0d1",opacity:1,hoverStyle:!1,specifyBorderRadius:!1,minSize:!1,size:"6px",disable:!1}}}},props:["top","left","width"],components:{Emoji:d},methods:{handleEmojiClick:function(t){this.$emit("emojiClick",t)}},mounted:function(){console.log(this.top,this.left,this.width)}},h=u,p=(n("08ce"),Object(l["a"])(h,i,s,!1,null,"c53de5e0",null));e["a"]=p.exports},"67ed":function(t,e,n){"use strict";var i=n("2e78"),s=n.n(i);s.a},"7fdf":function(t,e,n){},"95a3":function(t,e,n){"use strict";var i=n("b04f"),s=n.n(i);s.a},b04f:function(t,e,n){},bb13:function(t,e,n){"use strict";var i=n("7fdf"),s=n.n(i);s.a},d547:function(t,e,n){},fa20:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"arcontainer"}},[n("div",{staticClass:"go"},[n("span",{on:{click:t.goback}},[t._v("返回")])]),n("my-scroll",[n("div",{attrs:{id:"scrollbox"}},[n("div",{attrs:{id:"articlebox"}},[n("div",{staticClass:"titlebox"},[n("div",{staticClass:"decorated"}),n("div",{staticClass:"title",domProps:{innerHTML:t._s(t.content.title)}})]),n("div",{attrs:{id:"arother"}},[n("span",[n("i",{staticClass:"el-icon-view"}),t._v(" "+t._s(t.views)+" ")]),n("span",[n("i",{staticClass:"el-icon-s-grid"}),t._v(" "+t._s(this.category[0])+" ")]),n("span",[n("i",{staticClass:"el-icon-date"}),t._v(" "+t._s(t.content.date)+" ")])]),n("div",{directives:[{name:"highlight",rawName:"v-highlight"}],staticClass:"markdown-body",domProps:{innerHTML:t._s(t.content.content)}}),n("comment",{attrs:{id:t.id,title:t.content.title}})],1)])])],1)},s=[],a=(n("dca8"),n("96cf"),n("1da1")),o=(n("64e1"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"combox"},[n("div",{staticClass:"titlebox"},[t._v("评论区 ("+t._s(t.count)+")")]),n("div",{staticClass:"inputbox"},[n("div",{staticClass:"area"},[n("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",minlength:"2",maxlength:"150","show-word-limit":"",resize:"none",rows:"7",id:"textpanel"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),n("div",{staticClass:"user"},[n("el-input",{attrs:{placeholder:"请输入用户名",minlength:"2",maxlength:"8",disabled:t.disabled},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}}),n("div",{staticClass:"imgbox"},[t._v(" 选择头像： "),t._l(t.srcList,(function(e,i){return n("img",{key:i,class:i==t.currentIndex?"active":"",attrs:{src:e,alt:""},on:{click:function(e){return t.changeIndex(i)}}})}))],2),n("div",{staticClass:"icon clearfix"},[n("img",{staticClass:"emoji-panel-btn",attrs:{src:"/images/face.png"},on:{click:t.changeShow}}),n("el-button",{staticStyle:{height:"40px","margin-left":"30px",verticalAlign:"bottom"},attrs:{type:"primary"},on:{click:t.postCom}},[t._v("发表评论")]),t.showEmoji?n("emoji-panel",{attrs:{top:"-170px",left:"-235px",width:"400px"},on:{emojiClick:t.appendEmoji}}):t._e()],1)],1)]),n("transition-group",{staticClass:"comment",attrs:{tag:"div",name:"list"}},t._l(t.articleCom,(function(e,i){return n("div",{key:i,staticClass:"item"},[n("div",{staticClass:"username"},[n("img",{staticClass:"userimg",staticStyle:{borderRadius:"50%"},attrs:{src:e.user.isAuthor?t.admin.photo:e.imgSrc,alt:""}}),n("span",{staticClass:"from",class:e.user.isAuthor?"active":""},[t._v(t._s(e.user.isAuthor?t.admin.userName:e.user.name)+" "),e.user.isAuthor?n("i",{staticClass:"active"},[t._v("(博主)")]):t._e()])]),n("div",{staticClass:"info"},[n("div",{staticClass:"htmlcom",domProps:{innerHTML:t._s(e.content)}}),n("div",{staticClass:"otherbox"},[n("div",{staticClass:"time"},[t._v(t._s(e.date))]),n("div",{staticClass:"operation"},[t.$store.state.isLogin?n("i",{staticClass:"el-icon-delete delete",on:{click:function(n){return t.deleteCom(e._id)}}}):t._e(),n("i",{staticClass:"iconfont icon-message",staticStyle:{fontSize:"15px"},on:{click:function(e){return t.changeParentIndex(i)}}},[t._v("("+t._s(e.children.length)+")")])])]),i==t.parentIndex?n("div",[n("com-item",{attrs:{top:"-80px",left:"0px",width:"400px"},on:{handleCom:function(n){return t.handleCom(n,{toUser:e.user,id:e._id})}}}),e.children.length?n("div",{staticClass:"childcomt"},t._l(e.children,(function(s,a){return n("div",{key:a,staticClass:"child_item"},[n("div",{staticClass:"namebox"},[n("span",{staticClass:"from",class:s.fromUser.isAuthor?"active":""},[t._v(t._s(s.fromUser.isAuthor?t.admin.userName:s.fromUser.name)+" "),s.fromUser.isAuthor?n("i",{staticClass:"active"},[t._v("(博主)")]):t._e()]),n("span",[t._v("回复")]),n("span",{staticClass:"to",class:s.toUser.isAuthor?"active":""},[t._v(t._s(s.toUser.isAuthor?t.admin.userName:s.toUser.name)+" "),s.toUser.isAuthor?n("i",{staticClass:"active"},[t._v("(博主)")]):t._e()])]),n("div",{staticClass:"c_content",domProps:{innerHTML:t._s(s.c_content)}}),n("div",{staticClass:"c_other"},[n("div",{staticClass:"c_time"},[t._v(" "+t._s(s.c_date)+" ")]),n("div",{staticClass:"c_opera"},[t.$store.state.isLogin?n("i",{staticClass:"el-icon-delete delete",on:{click:function(n){return t.deleteCom(e._id,s.c_date)}}}):t._e(),n("i",{staticClass:"iconfont icon-message",staticStyle:{fontSize:"15px"},on:{click:function(e){return t.chageComIndex(i,a)}}})])]),-Math.ceil(i+1)+""+a==t.comIndex?n("div",[n("com-item",{attrs:{top:"-80px",left:"0px",width:"400px"},on:{handleCom:function(n){return t.handleCom(n,{toUser:s.fromUser,id:e._id})}}})],1):t._e()])})),0):t._e()],1):t._e()])])})),0),n("div",{staticClass:"pagebox"},[n("el-pagination",{attrs:{"page-size":t.limit,layout:"prev, pager, next",total:t.total,"hide-on-single-page":!0},on:{"current-change":t.handleCurrentChange}})],1)],1)}),r=[],c=(n("d81d"),n("b0c0"),n("ac1f"),n("5319"),n("0b86")),l=n("6180"),m=n("0c6d"),d={data:function(){return{admin:"",disabled:!1,articleCom:[],content:"",userName:"",showEmoji:!1,total:0,count:0,page:1,limit:5,parentIndex:-1,comIndex:0,currentIndex:0,srcList:["/images/1.png","/images/2.png","/images/3.png","/images/4.png"]}},props:["id","title"],created:function(){this.getCom()},mounted:function(){this.admin=this.$store.state.admin,this.disabled=this.$store.state.isLogin},components:{comItem:c["a"],EmojiPanel:l["a"]},methods:{changeShow:function(){this.showEmoji=!this.showEmoji},handleCurrentChange:function(t){this.page=t,this.getCom(),this.parentIndex=-1,this.comIndex=0},postCom:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.content.replace(/:.*?:/g,t.emoji),i={},!t.$store.state.isLogin){e.next=6;break}i={name:"博主",isAuthor:!0},e.next=12;break;case 6:if(""!=t.userName&&""!=t.comment){e.next=11;break}return t.$notify.error({title:"错误",message:"用户名或者评论不能为空"}),e.abrupt("return");case 11:i={name:t.userName,isAuthor:!1};case 12:return e.next=14,Object(m["a"])({url:"/comment/release",data:{article:t.id,arName:t.title,user:i,content:n,imgSrc:t.srcList[t.currentIndex],date:t.$dateFormat("YYYY-mm-dd HH:MM:SS",new Date)},method:"post"});case 14:if(s=e.sent,t.$store.state.isLogin){e.next=19;break}return e.next=18,Object(m["a"])({url:"/unread/release",data:{article:t.id,arName:t.title,parentId:s.data._id,fromUser:i.name,toUser:"博主",content:n,date:t.$dateFormat("YYYY-mm-dd HH:MM:SS",new Date)},method:"post"});case 18:e.sent;case 19:t.getCom(),t.content="",t.userName="";case 22:case"end":return e.stop()}}),e)})))()},getCom:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(m["a"])({url:"/comment/obtain",data:{article:t.id,limit:t.limit,page:t.page},method:"get"});case 2:n=e.sent,t.articleCom=n.data.map((function(t){return t.children&&(t.children=t.children.reverse()),t})),t.total=n.total,t.count=n.count;case 6:case"end":return e.stop()}}),e)})))()},changeIndex:function(t){this.currentIndex=t},changeParentIndex:function(t){this.parentIndex==t?this.parentIndex=-1:this.parentIndex=t},chageComIndex:function(){var t=-[Math.ceil(arguments[0]+1)+""+arguments[1]];this.comIndex==t?this.comIndex=0:this.comIndex=t},handleCom:function(t,e){var n=this;return Object(a["a"])(regeneratorRuntime.mark((function i(){var s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return s={fromUser:t.fromUser,c_content:t.c_content,c_date:n.$dateFormat("YYYY-mm-dd HH:MM:SS",t.c_date),toUser:e.toUser,parentId:e.id},i.next=3,Object(m["a"])({url:"/comment/release/child",data:s,method:"post"});case 3:if(i.sent,n.$store.state.isLogin){i.next=8;break}return i.next=7,UnreadCom({article:n.id,arName:n.title,fromUser:t.fromUser.name,toUser:e.toUser.name,content:t.c_content,parentId:e.id,date:n.$dateFormat("YYYY-mm-dd HH:MM:SS",new Date)});case 7:i.sent;case 8:n.getCom(),n.comIndex=0;case 10:case"end":return i.stop()}}),i)})))()},deleteCom:function(){var t=arguments,e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var i,s,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=t[0],s=-1,2==t.length&&(s=t[1]),n.next=5,Object(m["a"])({url:"/comment/remove",data:{_id:i,c_date:s},method:"post"});case 5:a=n.sent,a.status?(e.$notify({title:"成功",message:a.msg,type:"success"}),e.getCom()):e.$notify.error({title:"错误",message:a.msg});case 7:case"end":return n.stop()}}),n)})))()},emoji:function(t){var e=t.substring(1,t.length-1);return'<span class="emoji-item-common emoji-'.concat(e,' emoji-size-small" ></span>')},appendEmoji:function(t){var e=document.getElementById("textpanel");this.content=e.value+":"+t+":",this.showEmoji=!1}}},u=d,h=(n("95a3"),n("3082"),n("2877")),p=Object(h["a"])(u,o,r,!1,null,"6492357b",null),f=p.exports,g={data:function(){return{comment:[],id:"",category:[],content:{},views:null,distance:null,page:null}},components:{Comment:f},created:function(){var t=this.$route.query,e=t.distance,n=t.page,i=t.id;this.id=i,this.distance=e,this.page=n,this.getarticle()},watch:{$route:function(t,e){this.getarticle()}},methods:{getarticle:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(m["a"])({url:"/article/get",data:{id:t.$route.query.id},method:"get"});case 2:n=e.sent,t.content=Object.freeze(n.data[0]),t.comment=Object.freeze(n.comment),t.category=Object.freeze(t.content.category),t.views=Object.freeze(t.content.views);case 7:case"end":return e.stop()}}),e)})))()},goback:function(){this.$router.push({path:"/home",query:{distance:this.distance,page:this.page}})}}},v=g,_=(n("67ed"),Object(h["a"])(v,i,s,!1,null,null,null));e["default"]=_.exports}}]);